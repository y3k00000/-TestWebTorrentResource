<html>
<head>
  <title>TestResource</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/webtorrent@latest/webtorrent.min.js"></script>
<body>
<img style="width:800px;height:600;" id="pictore"/>
<script>
console.log(WebTorrent.WEBRTC_SUPPORT);
var magnet = "magnet:?xt=urn:btih:0a732ea77424fec27fd98201d97a820bbf64e0f0&dn=ic_launcher.png&tr=ws%3A%2F%2Fapi.cmoremap.com.tw%3A5566&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com";
var client = new WebTorrent();
client.add(magnet, async torrent => {
  console.log('Client is downloading:', torrent.infoHash);
  torrent.files.forEach(async file => {
    // file.appendTo("body");
    console.log(file);
    try{
      await new Promise((res,rej)=>{
        file.getBlobURL((err,url) => {
          if (err) rej(err);
          else {
            document.querySelector("#pictore").src= url;
            alert(url);
            res(url);
          }
        });
      });
    } catch(e){
      alert(e);
    }
  });
})

</script>
</body>

</html>
